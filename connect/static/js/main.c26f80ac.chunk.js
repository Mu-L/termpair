(this.webpackJsonptermpairjs=this.webpackJsonptermpairjs||[]).push([[0],{12:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return b}));var r=n(3),a=n.n(r),c=n(4),i=n(7);function s(){return JSON.stringify({event:"request_terminal_dimensions"})}function o(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,Object(i.d)(t);case 3:return e.t1=e.sent,e.t2={browser_public_key_pem:e.t1},e.t3={event:"new_browser_connected",payload:e.t2},e.abrupt("return",e.t0.stringify.call(e.t0,e.t3));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t,n){return d.apply(this,arguments)}function d(){return(d=Object(c.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,Object(i.b)(t,n,r);case 3:return e.t1=e.sent,e.t2={event:"command",payload:e.t1},e.abrupt("return",e.t0.stringify.call(e.t0,e.t2));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return JSON.stringify({event:"request_key_rotation"})}},23:function(e,t,n){"use strict";(function(e){var r=n(3),a=n.n(r),c=n(4),i=n(2),s=n(5),o=n(8),l=n(9),u=n(10),d=n(0),b=n.n(d),p=(n(42),n(24)),h=n(29),m=n(25),f=n(26),x=n.n(f),j=n(7),v=n(6),y=(n(44),n(27)),w=n(12),O=n(28),k=n(1),g=Object(k.jsx)("svg",{width:"24",height:"24",fill:"currentColor",className:"text-white mr-3 ",children:Object(k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.463 2 11.97c0 4.404 2.865 8.14 6.839 9.458.5.092.682-.216.682-.48 0-.236-.008-.864-.013-1.695-2.782.602-3.369-1.337-3.369-1.337-.454-1.151-1.11-1.458-1.11-1.458-.908-.618.069-.606.069-.606 1.003.07 1.531 1.027 1.531 1.027.892 1.524 2.341 1.084 2.91.828.092-.643.35-1.083.636-1.332-2.22-.251-4.555-1.107-4.555-4.927 0-1.088.39-1.979 1.029-2.675-.103-.252-.446-1.266.098-2.638 0 0 .84-.268 2.75 1.022A9.606 9.606 0 0112 6.82c.85.004 1.705.114 2.504.336 1.909-1.29 2.747-1.022 2.747-1.022.546 1.372.202 2.386.1 2.638.64.696 1.028 1.587 1.028 2.675 0 3.83-2.339 4.673-4.566 4.92.359.307.678.915.678 1.846 0 1.332-.012 2.407-.012 2.734 0 .267.18.577.688.48C19.137 20.107 22 16.373 22 11.969 22 6.463 17.522 2 12 2z"})});function C(e){return Object(k.jsxs)("div",{className:"flex bg-black h-10 items-center justify-between",children:[Object(k.jsx)("div",{className:"h-full",children:Object(k.jsx)("a",{href:window.location.pathname,children:Object(k.jsx)("img",{className:"h-full",src:p.a,alt:"logo"})})}),Object(k.jsx)("a",{href:"https://github.com/cs01/termpair",children:g})]})}function S(e){var t,n,r="Connected"===e.status,a=null!=e.terminalId?Object(k.jsx)("div",{children:e.status}):null,c=r?Object(k.jsx)("div",{title:"Whether you are allowed to send data to the terminal's input. This setting is controlled when initially sharing the terminal, and cannot be changed after sharing has begun.",children:(null===(t=e.terminalData)||void 0===t?void 0:t.allow_browser_control)&&"Connected"===e.status?"can type":"cannot type"}):null,i=r?Object(k.jsxs)("div",{title:"Number of other browsers connected to this terminal",children:[e.numClients?e.numClients:"0"," Connected Client(s)"]}):null,s=r?Object(k.jsxs)("div",{children:["Started at"," ",x()(null===(n=e.terminalData)||void 0===n?void 0:n.broadcast_start_time_iso).format("h:mm a on MMM Do, YYYY")]}):null,o=r?Object(k.jsxs)("span",{title:"Dimensions of terminal, rows x cols",children:[e.terminalSize.rows,"x",e.terminalSize.cols]}):null;return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"flex ".concat(r?"bg-green-900":"bg-red-900","   justify-evenly text-gray-300"),children:[a,o,c,i,s]}),Object(k.jsx)("div",{className:"flex bg-black  justify-evenly text-gray-300 py-5",children:Object(k.jsxs)("div",{children:[Object(k.jsx)("a",{href:"https://chadsmith.dev",children:"chadsmith.dev"})," |"," ",Object(k.jsx)("a",{href:"https://github.com/cs01/termpair",children:"GitHub"})," |"," ",Object(k.jsx)("a",{href:"https://github.com/cs01",children:"Other Projects"})]})})]})}var _=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={hasError:!1},r}return Object(o.a)(n,[{key:"componentDidCatch",value:function(e,t){console.error(e),console.error(t)}},{key:"render",value:function(){return this.state.hasError?Object(k.jsx)("h1",{className:"text-white",children:"Something went wrong."}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(b.a.Component),N="Terminal was shared in read only mode. Unable to send data to terminal's input.",T="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.pathname),E=window.location.port;window.location.port||(E="https:"===window.location.protocol?"443":"80");var I='termpair share --host "'.concat(T,'" --port ').concat(E),L="pipx run ".concat(I);function P(e){var t=Object(d.useState)(!1),n=Object(i.a)(t,2),r=n[0],a=n[1],c=Object(d.useState)(!1),s=Object(i.a)(c,2),o=s[0],l=s[1];return Object(k.jsxs)("div",{className:"flex",children:[Object(k.jsx)("code",{className:"".concat(o||r?"bg-yellow-200":"bg-gray-400"," text-black px-2 py-1 m-2"),children:e.command}),Object(k.jsx)(O.CopyToClipboard,{text:e.command,children:Object(k.jsx)("button",{className:"px-2",title:"Copy command to clipboard",onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},onClick:function(){a(!0),setTimeout((function(){return a(!1)}),1500)},children:Object(k.jsx)(h.a,{className:"h-6 w-6 text-white"})})}),Object(k.jsx)("span",{className:"py-1 m-2",children:r?"Copied!":""})]})}function A(e){var t=b.a.useState(""),n=Object(i.a)(t,2),r=n[0],a=n[1],c=b.a.useState(""),s=Object(i.a)(c,2),o=s[0],l=s[1],u=function(){if(r)if(e.isStaticallyHosted||e.setTerminalId(r),o){try{new URL(o)}catch(t){return void v.b.dark("".concat(o," is not a valid url"))}e.setCustomTermpairServer(o),e.setTerminalId(r)}else v.b.dark("Host name cannot be empty");else v.b.dark("Terminal ID cannot be empty")},d="text-black px-2 py-3 m-2 w-full font-mono",p=Object(k.jsxs)("div",{className:"flex items-center",title:"The unique Terminal ID the broadcasting terminal was provided when the sharing session began.",children:[Object(k.jsx)("span",{className:"py-2 m-2 whitespace-nowrap text-xl",children:"Terminal ID"}),Object(k.jsx)("input",{type:"text",className:d,onChange:function(e){a(e.target.value)},value:r,placeholder:"abcdef123456789abcded123456789",onKeyPress:function(e){"Enter"===e.key&&u()}})]}),h=Object(k.jsxs)("div",{className:"flex items-center",title:"The URL of an actual TermPair server that the terminal is broadcasting through.",children:[Object(k.jsx)("span",{className:"py-2 m-2 whitespace-nowrap text-xl",children:"TermPair Server URL"}),Object(k.jsx)("input",{type:"text",className:d,placeholder:"http://localhost:8000",onChange:function(e){l(e.target.value)},value:o,onKeyPress:function(e){"Enter"===e.key&&u()}})]}),m=e.isStaticallyHosted?0!==r.length:0!==r.length&&0!==o.length,f=Object(k.jsx)("div",{className:"flex justify-end",children:Object(k.jsx)("button",{title:"Connect to the specified Terminal",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full ".concat(m?"":"cursor-not-allowed"),onClick:u,children:"Connect"})}),x=Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-2xl py-2",children:"This page is statically hosted"}),Object(k.jsx)("div",{children:"This is a static page serving the TermPair JavaScript app. It is optional to use a statically served TermPair webapp, but it facilitates easily building and self-serving to be certain the JavaScript app has not been tampered with by an untrusted server."}),Object(k.jsx)("div",{className:"mt-5",children:"Connect to a broadcasting terminal by entering the fields below and clicking Connect."}),p,h,f]}),j=Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-xl  py-2",children:"Quick Start"}),Object(k.jsx)("div",{children:"If you have TermPair installed, share a terminal with this host:"}),Object(k.jsx)(P,{command:I}),Object(k.jsx)("div",{children:"Or if you have pipx, you can run TermPair via pipx:"}),Object(k.jsx)(P,{command:L})]}),Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-xl  py-2",children:"Install TermPair"}),Object(k.jsx)("div",{children:"Install with pipx"}),Object(k.jsx)(P,{command:"pipx install termpair"}),Object(k.jsx)("div",{children:"Or install with pip"}),Object(k.jsx)(P,{command:"pip install termpair --user"})]}),Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-xl  py-2",children:"Connecting to a Terminal?"}),"If a terminal is already broadcasting and you'd like to connect to it, you don't need to install or run anything. Just enter the Terminal ID below and click Connect.",p,f]})]}),y=Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-xl  py-2",children:"TermPair Demo"}),Object(k.jsx)("div",{children:Object(k.jsx)("img",{alt:"Screencast of TermPair",src:"https://raw.githubusercontent.com/cs01/termpair/master/termpair_browser.gif"})})]});return Object(k.jsx)("div",{className:"flex justify-center",children:Object(k.jsxs)("div",{className:"text-gray-300 max-w-3xl",children:[Object(k.jsxs)("div",{className:"py-2",children:[Object(k.jsx)("div",{className:"text-3xl ",children:"Welcome to TermPair!"}),"Easily share terminals with end-to-end encryption \ud83d\udd12. Terminal data is always encrypted before being routed through the server."," ",Object(k.jsx)("a",{href:"https://github.com/cs01/termpair",children:"Learn more."})]}),null===e.isStaticallyHosted?null:!0===e.isStaticallyHosted?x:j,y]})})}var U=Object(y.debounce)((function(e){v.b.dark(e)}),500);function D(e){return"\x1b[1;31m"+e+"\x1b[0m"}t.a=function(){var t=Object(d.useState)(null),n=Object(i.a)(t,2),r=n[0],s=n[1],o=Object(d.useState)(null),l=Object(i.a)(o,2),u=l[0],b=l[1],p=Object(d.useState)(0),h=Object(i.a)(p,2),f=h[0],x=h[1],y=Object(d.useRef)(null),O=Object(d.useRef)({browser:null,unix:null,ivCount:null,maxIvCount:null}),g=Object(d.useState)(!1),T=Object(i.a)(g,2),E=T[0],I=T[1],L=Object(d.useState)({rows:20,cols:81}),P=Object(i.a)(L,2),R=P[0],K=P[1],F=Object(d.useState)(null),M=Object(i.a)(F,2),B=M[0],H=M[1],J=Object(d.useState)(null),z=Object(i.a)(J,2),W=z[0],Y=z[1],q=Object(d.useState)(null),G=Object(i.a)(q,2),Q=G[0],V=G[1],X=new URL("".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(window.location.port).concat(window.location.pathname)),Z=Object(d.useState)(new URLSearchParams(window.location.search).get("termpair_server_url")),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ne=!0===r?ee:X;Object(d.useEffect)((function(){!0===r&&ee&&v.b.dark("Terminal data is being routed through ".concat(ee.toString()))}),[ee]),Object(d.useEffect)((function(){(function(){var e=Object(c.a)(a.a.mark((function e(){var t,n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(X.toString()+"ping",{mode:"same-origin"});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,r="pong"===n,c=200===t.status&&r,s(!c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),s(!0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var re=ne?new URL(ne.toString().replace(/^http/,"ws")):null,ae=Object(d.useState)(new m.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e3})),ce=Object(i.a)(ae,1)[0],ie=Object(d.useState)(new URLSearchParams(window.location.search).get("terminal_id")),se=Object(i.a)(ie,2),oe=se[0],le=se[1];Object(d.useLayoutEffect)((function(){if(!E){var e=document.getElementById("terminal");e&&(ce.open(e),ce.writeln("Welcome to TermPair! https://github.com/cs01/termpair"),ce.writeln(""),I(!0))}}),[W]);var ue=function(e){Y(e),function(e,t,n,r,a){switch(n&&-1===["No Terminal provided"].indexOf(n)&&U(Object(k.jsxs)("div",{children:["Terminal status: ",n]})),a(n),n){case null:break;case"Connected":e.writeln("Connection established with end-to-end encryption \ud83d\udd12."),e.writeln("The termpair server and third parties can't read transmitted data."),e.writeln(""),e.writeln("You can copy text with ctrl+shift+c or ctrl+shift+x, and paste with ctrl+shift+v."),e.writeln("");break;case"Disconnected":"Connected"===r&&(e.writeln(D("Terminal session has ended")),e.writeln(""));break;case"Terminal ID is invalid":e.writeln(D("An invalid Terminal ID (".concat(t,") was provided. ")+"Check that the session is still being broadcast and that the ID is entered correctly.")),e.writeln("");break;case"Failed to obtain encryption keys":e.writeln(D("Failed to obtain symmetric encryption keys from the broadcasting terminal.")),e.writeln("");break;case"Developer Error: RSA key not ready":v.b.dark(Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{children:"Unexpected error: RSA Public key is not ready at time of websocket connection. Please file an issue."}),Object(k.jsx)("a",{href:"https://github.com/cs01/termpair/issues",children:"https://github.com/cs01/termpair/issues"})]}),{autoClose:!1});break;case"Browser is not running in a secure context":e.writeln(D("Fatal Error: TermPair only works on secure connections. Ensure url starts with https. See https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts and `termpair serve --help` for more information.")),e.writeln("");break;case"Connecting...":break;case"Connection Error":e.writeln(D("An error occurred in the websocket connection to the server. Connection has been closed."));break;case"No Terminal provided":case"Failed to fetch terminal data":case"Ready for websocket connection":break;default:!function(e){throw Error}()}}(ce,oe,e,Q,V)};Object(d.useEffect)((function(){function e(){return(e=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe){e.next=4;break}return b(null),ue("No Terminal provided"),e.abrupt("return");case 4:if(window.isSecureContext){e.next=7;break}return ue("Browser is not running in a secure context"),e.abrupt("return");case 7:if(!r||ee){e.next=10;break}return v.b.dark("Page is statically hosted but no custom server was provided"),e.abrupt("return");case 10:if(ne){e.next=13;break}return console.error("no termpair server"),e.abrupt("return");case 13:return e.next=15,Object(j.e)();case 15:return y.current=e.sent,e.prev=16,e.next=19,fetch(new URL("terminal/".concat(oe),ne).toString());case 19:if(200!==(t=e.sent).status){e.next=29;break}return e.t0=b,e.next=24,t.json();case 24:e.t1=e.sent,(0,e.t0)(e.t1),Y("Ready for websocket connection"),e.next=31;break;case 29:ue("Terminal ID is invalid"),b(null);case 31:e.next=38;break;case 33:e.prev=33,e.t2=e.catch(16),ue("Failed to fetch terminal data"),v.b.dark("Error fetching terminal data from ".concat(ne.toString(),". Is the URL correct? Error message: ").concat(String(e.t2.message)),{autoClose:!1}),b(null);case 38:case"end":return e.stop()}}),e,null,[[16,33]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[oe]),Object(d.useEffect)((function(){B&&clearTimeout(B),H(setTimeout((function(){ce.resize(R.cols,R.rows)}),500))}),[R,ce]),Object(d.useEffect)((function(){!function(){var t;if("Ready for websocket connection"===W&&(null===u||void 0===u?void 0:u.terminal_id)&&(null===(t=y.current)||void 0===t?void 0:t.privateKey)&&re){ue("Connecting...");var n,r=new URL("connect_browser_to_terminal?terminal_id=".concat(oe),re),i=new WebSocket(r.toString());ce.attachCustomKeyEventHandler(function(e,t,n){function r(r){if("keydown"!==r.type)return!0;if(r.ctrlKey&&r.shiftKey){var a=r.key.toLowerCase();if("v"===a)return t?(navigator.clipboard.readText().then((function(e){n(e)})),!1):(U(N),!1);if("c"===a||"x"===a){var c=e.getSelection();return navigator.clipboard.writeText(c),e.focus(),!1}}return!0}return r}(ce,null===u||void 0===u?void 0:u.allow_browser_control,function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(O.current.browser&&O.current.ivCount&&O.current.maxIvCount)){e.next=10;break}return e.t0=i,e.next=5,Object(w.d)(O.current.browser,t,O.current.ivCount++);case 5:e.t1=e.sent,e.t0.send.call(e.t0,e.t1),Object(j.g)(O.current.ivCount,O.current.maxIvCount)&&(i.send(Object(w.b)()),O.current.maxIvCount+=1e3),e.next=12;break;case 10:return v.b.dark("Can't send ".concat(t," since encryption key was not obtained. Wait and try again or refresh the page.")),e.abrupt("return");case 12:e.next=17;break;case 14:e.prev=14,e.t2=e.catch(0),v.b.dark("Failed to send data to terminal ".concat(e.t2));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}())),i.addEventListener("open",function(){var e=Object(c.a)(a.a.mark((function e(t){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(null===(r=y.current)||void 0===r?void 0:r.publicKey)){e.next=3;break}return ue("Developer Error: RSA key not ready"),e.abrupt("return");case 3:return ue("Connected"),i.send(Object(w.c)()),e.next=7,Object(w.a)(y.current.publicKey);case 7:s=e.sent,i.send(s),n=ce.onData(function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!1!==u.allow_browser_control){e.next=4;break}return U(N),e.abrupt("return");case 4:if(null==O.current.browser||null==O.current.ivCount||null==O.current.maxIvCount){e.next=13;break}return e.t0=i,e.next=8,Object(w.d)(O.current.browser,t,O.current.ivCount++);case 8:e.t1=e.sent,e.t0.send.call(e.t0,e.t1),Object(j.g)(O.current.ivCount,O.current.maxIvCount)&&(i.send(Object(w.b)()),O.current.maxIvCount+=1e3),e.next=14;break;case 13:v.b.dark("cannot send ".concat(t," because encryption key is missing"));case 14:e.next=19;break;case 16:e.prev=16,e.t2=e.catch(0),v.b.dark("Failed to send data to terminal ".concat(e.t2));case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.addEventListener("close",(function(e){n&&n.dispose(),ue("Disconnected"),x(0)})),i.addEventListener("error",(function(e){n&&n.dispose(),v.b.dark("Websocket Error: ".concat(e)),console.error(e),ue("Connection Error"),x(0)})),i.addEventListener("message",function(){var t=Object(c.a)(a.a.mark((function t(n){var r,c,i,s,o,l,u,d,b,p,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("new_output"!==(r=JSON.parse(n.data)).event){t.next=12;break}if(O.current.unix){t.next=5;break}return console.error("Missing AES CryptoKey for unix terminal. Cannot decrypt message."),t.abrupt("return");case 5:return c=r.payload,t.next=8,Object(j.a)(O.current.unix,c);case 8:i=t.sent,ce.write(i),t.next=83;break;case 12:if("resize"!==r.event){t.next=16;break}r.payload.cols&&r.payload.rows&&K({cols:r.payload.cols,rows:r.payload.rows}),t.next=83;break;case 16:if("num_clients"!==r.event){t.next=21;break}s=r.payload,x(s),t.next=83;break;case 21:if("aes_keys"!==r.event){t.next=57;break}if(null===y||void 0===y||null===(o=y.current)||void 0===o?void 0:o.privateKey){t.next=24;break}return t.abrupt("return");case 24:return t.prev=24,t.next=27,Object(j.c)(y.current.privateKey,e.from(r.payload.b64_pk_unix_aes_key,"base64"));case 27:return l=t.sent,t.next=30,Object(j.f)(l,["decrypt"]);case 30:return O.current.unix=t.sent,t.next=33,Object(j.c)(y.current.privateKey,e.from(r.payload.b64_pk_browser_aes_key,"base64"));case 33:return u=t.sent,t.next=36,Object(j.f)(u,["encrypt"]);case 36:if(O.current.browser=t.sent,null!=r.payload.iv_count&&null!=r.payload.max_iv_count){t.next=40;break}throw console.error("missing required iv parameters"),Error("missing required iv parameters");case 40:if(d=O.current.ivCount=parseInt(r.payload.iv_count,10),!((b=O.current.maxIvCount=parseInt(r.payload.max_iv_count,10))<d)){t.next=46;break}throw console.error("Initialized IV counter is below max value ".concat(d," vs ").concat(b)),O.current={browser:null,maxIvCount:null,ivCount:null,unix:null},Error;case 46:t.next=55;break;case 48:if(t.prev=48,t.t0=t.catch(24),null!=O.current.browser&&null!=O.current.unix&&null!=O.current.ivCount&&null!=O.current.maxIvCount){t.next=55;break}return console.error(t.t0),console.error(r),ue("Failed to obtain encryption keys"),t.abrupt("return");case 55:t.next=83;break;case 57:if("aes_key_rotation"!==r.event){t.next=82;break}if(O.current.unix){t.next=61;break}return console.error("Cannot decrypt new AES keys"),t.abrupt("return");case 61:return t.prev=61,t.next=64,Object(j.a)(O.current.unix,r.payload.b64_aes_secret_unix_key);case 64:return p=t.sent,t.next=67,Object(j.a)(O.current.unix,r.payload.b64_aes_secret_browser_key);case 67:return h=t.sent,t.next=70,Object(j.f)(h,["encrypt"]);case 70:return O.current.browser=t.sent,t.next=73,Object(j.f)(p,["decrypt"]);case 73:O.current.unix=t.sent,t.next=80;break;case 76:t.prev=76,t.t1=t.catch(61),console.error(t.t1),v.b.dark("AES key rotation failed: ".concat(t.t1));case 80:t.next=83;break;case 82:"error"===r.event?(v.b.dark("Error: ".concat(r.payload)),console.error(r)):(v.b.dark("Unknown event received: ".concat(r.event)),console.error("unknown event type",r));case 83:case"end":return t.stop()}}),t,null,[[24,48],[61,76]])})));return function(e){return t.apply(this,arguments)}}())}}()}),[u,W]);var de=[null,"No Terminal provided","Failed to fetch terminal data"].indexOf(W)>-1||null===r,be=Object(k.jsx)("div",{className:"p-5 text-white flex-grow",children:de?Object(k.jsx)(A,{isStaticallyHosted:r,setCustomTermpairServer:te,setTerminalId:le}):Object(k.jsx)("div",{id:"terminal",className:" p-3 bg-black flex-grow text-gray-400"})});return Object(k.jsx)(_,{children:Object(k.jsxs)("div",{className:"flex flex-col h-screen align-middle",children:[Object(k.jsx)(v.a,{position:"bottom-right",limit:3,autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!0,pauseOnHover:!0}),Object(k.jsx)(C,{}),be,Object(k.jsx)(S,{terminalData:u,status:W,terminalId:oe,terminalSize:R,numClients:f})]})})}}).call(this,n(22).Buffer)},24:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.0cb35f08.png"},31:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(13),i=n.n(c),s=(n(36),n(23)),o=n(30),l=n(1);i.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(o.a,{children:Object(l.jsx)(s.a,{})})}),document.getElementById("root"))},36:function(e,t,n){},7:function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return j})),n.d(t,"g",(function(){return y}));var r=n(3),a=n.n(r),c=n(4);function i(){return s.apply(this,arguments)}function s(){return(s=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(e,t){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(a.a.mark((function t(n,r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,window.crypto.subtle.decrypt({name:"RSA-OAEP"},n,r);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.from.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function d(e){return b.apply(this,arguments)}function b(){return(b=Object(c.a)(a.a.mark((function e(t){var n,r,c,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey("spki",t);case 2:return n=e.sent,r=u(n),c=window.btoa(r),i="-----BEGIN PUBLIC KEY-----\n".concat(c,"\n-----END PUBLIC KEY-----"),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return f.apply(this,arguments)}function f(){return(f=Object(c.a)(a.a.mark((function t(n,r){var c,i,s,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.from(r,"base64"),i=c.subarray(0,12),s=c.subarray(12),t.t0=e,t.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},n,s);case 6:return t.t1=t.sent,o=t.t0.from.call(t.t0,t.t1),t.abrupt("return",o);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(e){var t=new Uint8Array(12),n=[];for(n.unshift(255&e);e>=256;)e>>>=8,n.unshift(255&e);return t.set(n),t}function j(e,t,n){return v.apply(this,arguments)}function v(){return(v=Object(c.a)(a.a.mark((function e(t,n,r){var c,i,s,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=x(r),e.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},t,(new TextEncoder).encode(n));case 3:return i=e.sent,s=w(c,i),o=O(s),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return e>=t}function w(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}function O(e){for(var t=new Uint8Array(e),n="",r=t.byteLength,a=0;a<r;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}}).call(this,n(22).Buffer)}},[[31,1,2]]]);
//# sourceMappingURL=main.c26f80ac.chunk.js.map